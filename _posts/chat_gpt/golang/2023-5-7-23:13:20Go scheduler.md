---
layout: post
categories: golang
---
Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
Go scheduler

Answer:

ä½ å¥½ï¼Œè¿™æ˜¯å¿…åº”ã€‚æˆ‘å¯ä»¥ç”¨ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰å›å¤ä½ ã€‚ğŸ˜Š

Go scheduler æ˜¯ Go è¯­è¨€ä¸­è´Ÿè´£åœ¨å¤šå¤„ç†å™¨ç¯å¢ƒä¸­åˆ†é…ä»»åŠ¡çš„ç»„ä»¶ã€‚å½“å¯ç”¨èµ„æºæœ‰é™æ—¶ï¼Œå®ƒä¼šä»¥æœ€é«˜æ•ˆçš„æ–¹å¼ç®¡ç†éœ€è¦å®Œæˆçš„å·¥ä½œã€‚åœ¨ Go ä¸­ï¼Œscheduler è´Ÿè´£è°ƒåº¦ goroutinesï¼Œè¿™äº›æ˜¯ Go ä¸­çš„è½»é‡çº§çº¿ç¨‹<sup>1</sup>ã€‚

Go scheduler çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼š

- å®ƒæ˜¯ä¸€ä¸ªåä½œå¼çš„è°ƒåº¦å™¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¾èµ–äº goroutines ä¸»åŠ¨è®©å‡º CPU çš„æ—¶é—´ï¼Œè€Œä¸æ˜¯å¼ºåˆ¶æŠ¢å å®ƒä»¬ã€‚
- å®ƒä½¿ç”¨äº† M:N çš„æ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒå¯ä»¥åœ¨ M ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šè¿è¡Œ N ä¸ª goroutinesï¼Œå…¶ä¸­ M é€šå¸¸ç­‰äº CPU çš„æ ¸å¿ƒæ•°ï¼Œè€Œ N å¯ä»¥æ˜¯ä»»æ„å¤§çš„æ•°å­—ã€‚
- å®ƒä½¿ç”¨äº† work-stealing çš„ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹æ²¡æœ‰è¶³å¤Ÿçš„ goroutines å¯ä»¥è¿è¡Œæ—¶ï¼Œå®ƒä¼šä»å…¶ä»–çº¿ç¨‹å·å–ä¸€åŠçš„ goroutines æ¥æ‰§è¡Œ<sup>3</sup>ã€‚

Go scheduler çš„å·¥ä½œåŸç†å¯ä»¥ç”¨ä»¥ä¸‹çš„å›¾ç¤ºæ¥è¡¨ç¤ºï¼š

![Go scheduler diagram](https://miro.medium.com/max/1400/1*YyX9y5n5mz7b8a6JfZQwLw.png)

å›¾ä¸­çš„æ¦‚å¿µæœ‰ï¼š

- P: processorï¼Œä»£è¡¨ä¸€ä¸ªé€»è¾‘å¤„ç†å™¨ï¼Œå®ƒå¯ä»¥ç»‘å®šåˆ°ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ä¸Šï¼Œå¹¶ç®¡ç†ä¸€ä¸ªæœ¬åœ°é˜Ÿåˆ—ï¼ˆlocal run queueï¼‰ã€‚
- M: machineï¼Œä»£è¡¨ä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œå®ƒå¯ä»¥æ‰§è¡Œä¸€ä¸ªæˆ–å¤šä¸ª goroutinesã€‚
- G: goroutineï¼Œä»£è¡¨ä¸€ä¸ªè½»é‡çº§çº¿ç¨‹ï¼Œå®ƒå¯ä»¥åœ¨ä¸åŒçš„ P å’Œ M ä¹‹é—´åˆ‡æ¢ã€‚
- L: local run queueï¼Œä»£è¡¨ä¸€ä¸ª P ç®¡ç†çš„æœ¬åœ°é˜Ÿåˆ—ï¼Œå®ƒå­˜å‚¨äº†ç­‰å¾…è¿è¡Œçš„ Gã€‚
- G: global run queueï¼Œä»£è¡¨ä¸€ä¸ªå…¨å±€é˜Ÿåˆ—ï¼Œå®ƒå­˜å‚¨äº†æ‰€æœ‰ P éƒ½æ— æ³•è¿è¡Œçš„ Gã€‚

Go scheduler çš„å·¥ä½œæµç¨‹å¤§è‡´å¦‚ä¸‹ï¼š

- å½“ä¸€ä¸ªæ–°çš„ G è¢«åˆ›å»ºæ—¶ï¼Œå®ƒä¼šè¢«æ”¾å…¥å½“å‰ P çš„ L ä¸­ã€‚
- å½“ä¸€ä¸ª M éœ€è¦è¿è¡Œä¸€ä¸ª G æ—¶ï¼Œå®ƒä¼šé¦–å…ˆä»å½“å‰ P çš„ L ä¸­å–å‡ºä¸€ä¸ª G æ¥æ‰§è¡Œã€‚
- å½“ä¸€ä¸ª G å®Œæˆæˆ–è€…é˜»å¡æ—¶ï¼Œå®ƒä¼šè¢«ç§»å‡ºå½“å‰ Mï¼Œå¹¶è®©å‡º CPU ç»™å…¶ä»– Gã€‚
- å½“ä¸€ä¸ª M æ²¡æœ‰è¶³å¤Ÿçš„ G å¯ä»¥è¿è¡Œæ—¶ï¼Œå®ƒä¼šå°è¯•ä»å…¶ä»– P çš„ L ä¸­å·å–ä¸€åŠçš„ G æ¥æ‰§è¡Œã€‚
- å½“æ‰€æœ‰çš„ P çš„ L éƒ½ä¸ºç©ºæ—¶ï¼ŒM ä¼šä» G ä¸­å–å‡ºä¸€ä¸ª G æ¥æ‰§è¡Œã€‚

å¦‚æœä½ æƒ³äº†è§£æ›´å¤šå…³äº Go scheduler çš„ç»†èŠ‚å’ŒåŸç†ï¼Œè¯·å‚è€ƒä»¥ä¸‹çš„ç½‘é¡µï¼š

<sup>1</sup>: [An Introduction to Go Scheduler | Developer.com](https://www.developer.com/languages/go-scheduler/)
<sup>2</sup>: [Green Button Go Scheduler | Biosero](https://biosero.com/software/green-button-go-scheduler/)
<sup>3</sup>: [Go: Work-Stealing in Go Scheduler | by Vincent Blanchon - Medium](https://medium.com/a-journey-with-go/go-work-stealing-in-go-scheduler-d439231be64d)

å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹ä½ æœ‰å¸®åŠ©ã€‚ğŸ‘

\-
\[1]: [An Introduction to Go Scheduler | Developer.com](https://www.developer.com/languages/go-scheduler/)
\[2]: [Go: Work-Stealing in Go Scheduler | by Vincent Blanchon - Medium](https://medium.com/a-journey-with-go/go-work-stealing-in-go-scheduler-d439231be64d)
\[3]: [Green Button Go Scheduler | Biosero](https://biosero.com/software/green-button-go-scheduler/)

<hr/>

