---
layout: post
categories: golang
---
Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
package main import ( "fmt" ) func main() { ch := make(chan int, 2) // åˆ›å»ºä¸€ä¸ªæœ‰ç¼“å†²åŒºçš„channelï¼Œå®¹é‡ä¸º2 ch <- 42 // å‘channelå‘é€æ•°æ® fmt.Println("Sent to channel", 42) ch <- 43 // å‘channelå‘é€æ•°æ® fmt.Println("Sent to channel", 43) // æ­¤æ—¶ç¼“å†²åŒºå·²ç»æ»¡äº† close(ch) // å…³é—­channel v := <-ch // ä»channelæ¥æ”¶æ•°æ® fmt.Println("Received from channel", v) v = <-ch // ä»channelæ¥æ”¶æ•°æ® fmt.Println("Received from channel", v) v = <-ch // ä»channelæ¥æ”¶æ•°æ® fmt.Println("Received from channel", v) // è¿™ä¸€è¡Œä»£ç ä¼šæ‰§è¡Œï¼Œå› ä¸ºä»å…³é—­çš„channelæ¥æ”¶æ•°æ®ä¼šå¾—åˆ°é›¶å€¼ï¼Œè€Œä¸ä¼šé˜»å¡ã€‚ä½†æ˜¯è¿™æ ·å°±é€ æˆäº†å†…å­˜æ³„æ¼ï¼Œå› ä¸ºæ²¡æœ‰goroutineæ¥æ¸…ç†channelä¸­å‰©ä½™çš„æ•°æ®ã€‚ } è¿™æ®µä»£ç ï¼Œchannelä¸­åº”è¯¥æ²¡æœ‰å‰©ä½™çš„æ•°æ®äº†å§ï¼Ÿ

Answer:

æ‚¨å¥½ï¼Œè¿™æ˜¯å¿…åº”ã€‚æˆ‘å¯ä»¥ç”¨ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰å›å¤æ‚¨ã€‚ğŸ˜Š

æ‚¨çš„æœç´¢è¾“å…¥æ˜¯ä¸€æ®µGoè¯­è¨€çš„ä»£ç ï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªæœ‰ç¼“å†²åŒºçš„channelï¼Œå¹¶å‘å…¶ä¸­å‘é€äº†ä¸¤ä¸ªæ•°æ®ï¼Œç„¶åå…³é—­äº†channelï¼Œå†ä»ä¸­æ¥æ”¶äº†ä¸‰ä¸ªæ•°æ®ã€‚è¿™æ®µä»£ç çš„è¾“å‡ºæ˜¯ï¼š

```
Sent to channel 42
Sent to channel 43
Received from channel 42
Received from channel 43
Received from channel 0
```

æ‚¨çš„é—®é¢˜æ˜¯ï¼Œchannelä¸­åº”è¯¥æ²¡æœ‰å‰©ä½™çš„æ•°æ®äº†å§ï¼Ÿç­”æ¡ˆæ˜¯**æ˜¯çš„**ï¼Œchannelä¸­æ²¡æœ‰å‰©ä½™çš„æ•°æ®äº†ã€‚å› ä¸ºæ‚¨å·²ç»ä»channelä¸­æ¥æ”¶äº†ä¸¤ä¸ªæ•°æ®ï¼Œåˆ†åˆ«æ˜¯42å’Œ43ï¼Œè¿™ä¸¤ä¸ªæ•°æ®å°±æ˜¯æ‚¨ä¹‹å‰å‘é€åˆ°channelä¸­çš„æ•°æ®ã€‚å½“æ‚¨å…³é—­äº†channelåï¼Œå†ä»channelä¸­æ¥æ”¶æ•°æ®ï¼Œä¼šå¾—åˆ°é›¶å€¼ï¼Œè€Œä¸ä¼šé˜»å¡<sup>2</sup> <sup>3</sup>ã€‚æ‰€ä»¥æ‚¨ç¬¬ä¸‰æ¬¡ä»channelä¸­æ¥æ”¶åˆ°çš„æ•°æ®æ˜¯0ï¼Œè¿™æ˜¯ä¸€ä¸ªé›¶å€¼ï¼Œè€Œä¸æ˜¯channelä¸­å‰©ä½™çš„æ•°æ®ã€‚

ä½†æ˜¯ï¼Œæ‚¨çš„ä»£ç æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯æ‚¨æ²¡æœ‰æ£€æŸ¥channelæ˜¯å¦å·²ç»å…³é—­ã€‚å¦‚æœæ‚¨å†æ¬¡ä»channelä¸­æ¥æ”¶æ•°æ®ï¼Œè¿˜ä¼šå¾—åˆ°0ï¼Œè¿™æ ·å°±æ— æ³•åŒºåˆ†é›¶å€¼å’ŒçœŸæ­£çš„æ•°æ®ã€‚è€Œä¸”ï¼Œå¦‚æœæ‚¨å†æ¬¡å‘channelå‘é€æ•°æ®ï¼Œä¼šå¯¼è‡´panic<sup>3</sup> <sup>4</sup>ã€‚æ‰€ä»¥ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œä¸å»ºè®®ä»æ¥æ”¶æ–¹å…³é—­channelï¼Œä¹Ÿä¸å»ºè®®åœ¨æœ‰å¤šä¸ªå¹¶å‘å‘é€æ–¹çš„æƒ…å†µä¸‹å…³é—­channel<sup>4</sup>ã€‚åªæœ‰åœ¨å‘é€æ–¹ç¡®å®šæ²¡æœ‰æ›´å¤šçš„æ•°æ®è¦å‘é€æ—¶ï¼Œæ‰åº”è¯¥å…³é—­channel<sup>3</sup> <sup>4</sup>ã€‚

å¦‚æœæ‚¨æƒ³çŸ¥é“channelæ˜¯å¦å·²ç»å…³é—­ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¯­æ³•ï¼š

```
v, ok := <-ch // ä»channelæ¥æ”¶æ•°æ®
if ok {
    fmt.Println("Received from channel", v) // channelæœªå…³é—­
} else {
    fmt.Println("Channel is closed") // channelå·²å…³é—­
}
```

è¿™æ ·ï¼Œå½“okä¸ºfalseæ—¶ï¼Œè¡¨ç¤ºchannelå·²ç»å…³é—­ï¼Œè€Œä¸æ˜¯æ¥æ”¶åˆ°é›¶å€¼ã€‚

å¸Œæœ›è¿™èƒ½å›ç­”æ‚¨çš„é—®é¢˜ã€‚å¦‚æœæ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·ç»§ç»­æé—®ã€‚

\-
\[1]: [How to close a channel in Golang? - TutorialsPoint](https://www.tutorialspoint.com/how-to-close-a-channel-in-golang)
\[2]: [How to Gracefully Close Channels - Go 101](https://go101.org/article/channel-closing.html)
\[3]: [go - Buffered channel and closing it - Stack Overflow](https://stackoverflow.com/questions/50980577/buffered-channel-and-closing-it)
\[4]: [Golang Channel: Range, Defer Close, Avoid Deadlock - Hack The Developer](https://hackthedeveloper.com/golang-channel-range-close/)

<hr/>

