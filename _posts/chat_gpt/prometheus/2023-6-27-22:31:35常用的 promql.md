Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
å¸¸ç”¨çš„ promql

Answer:

æ‚¨å¥½ï¼Œè¿™æ˜¯å¿…åº”ã€‚æˆ‘å¯ä»¥ç”¨ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰å›å¤æ‚¨ã€‚ğŸ˜Š

å¸¸ç”¨çš„ promql æ˜¯æŒ‡ Prometheus æä¾›çš„ä¸€ç§å‡½æ•°å¼çš„è¡¨è¾¾å¼è¯­è¨€ï¼Œå¯ä»¥å®ç°å¯¹æ—¶é—´åºåˆ—æ•°æ®çš„æŸ¥è¯¢ã€èšåˆã€é€»è¾‘è¿ç®—ç­‰ã€‚PromQL æœ‰ä»¥ä¸‹å‡ ç§æ•°æ®ç±»å‹ï¼š

- ç¬æ—¶å‘é‡ (Instant vector): ä¸€ç»„æ—¶åºï¼Œæ¯ä¸ªæ—¶åºåªæœ‰ä¸€ä¸ªé‡‡æ ·å€¼
- åŒºé—´å‘é‡ (Range vector): ä¸€ç»„æ—¶åºï¼Œæ¯ä¸ªæ—¶åºåŒ…å«ä¸€æ®µæ—¶é—´å†…çš„å¤šä¸ªé‡‡æ ·å€¼
- æ ‡é‡æ•°æ® (Scalar): ä¸€ä¸ªæµ®ç‚¹æ•°
- å­—ç¬¦ä¸² (String): ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæš‚æ—¶æœªç”¨

PromQL è¿˜æ”¯æŒå¤šç§æ“ä½œç¬¦å’Œå‡½æ•°ï¼Œä¾‹å¦‚ï¼š

- ç®—æœ¯è¿ç®—ç¬¦ï¼š+ - * / %
- æ¯”è¾ƒè¿ç®—ç¬¦ï¼š== != > < >= <=
- é€»è¾‘è¿ç®—ç¬¦ï¼šand or unless
- èšåˆæ“ä½œç¬¦ï¼šsum avg min max count count_values topk bottomk quantile stddev stdvar
- å‡½æ•°ï¼šrate increase irate histogram_quantile label_replace label_join

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸ç”¨çš„ promql ç¤ºä¾‹ï¼š

- æŸ¥è¯¢æŸä¸ªæŒ‡æ ‡çš„å½“å‰å€¼ï¼š`node_cpu_seconds_total`
- æŸ¥è¯¢æŸä¸ªæŒ‡æ ‡åœ¨è¿‡å»5åˆ†é’Ÿå†…çš„å¹³å‡å¢é•¿ç‡ï¼š`rate(node_cpu_seconds_total[5m])`
- æŸ¥è¯¢æŸä¸ªæŒ‡æ ‡åœ¨è¿‡å»5åˆ†é’Ÿå†…çš„æœ€å¤§å€¼ï¼š`max_over_time(node_cpu_seconds_total[5m])`
- æŸ¥è¯¢æŸä¸ªæŒ‡æ ‡æŒ‰ç…§æ ‡ç­¾åˆ†ç»„æ±‚å’Œï¼š`sum by (mode) (node_cpu_seconds_total)`
- æŸ¥è¯¢æŸä¸ªæŒ‡æ ‡æŒ‰ç…§æ ‡ç­¾è¿‡æ»¤ï¼š`node_cpu_seconds_total{mode="idle"}`
- æŸ¥è¯¢ä¸¤ä¸ªæŒ‡æ ‡çš„æ¯”ä¾‹ï¼š`node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes`
- æŸ¥è¯¢ä¸¤ä¸ªæŒ‡æ ‡çš„è¿æ¥ï¼š`node_load1 * on(instance) group_left(mode) node_cpu_seconds_total{mode="system"}`
- æŸ¥è¯¢æŸä¸ªæŒ‡æ ‡çš„åˆ†ä½æ•°ï¼š`histogram_quantile(0.95, rate(http_request_duration_seconds_bucket[5m]))`

æ›´å¤šå…³äº promql çš„ä¿¡æ¯ï¼Œè¯·å‚è€ƒä»¥ä¸‹é“¾æ¥ï¼š

<sup>1</sup>: [Prometheus å¿«é€Ÿå…¥é—¨æ•™ç¨‹ï¼ˆå››ï¼‰ï¼šPromQL å¿«é€Ÿå…¥é—¨ - é™ˆæ ‘ä¹‰ - åšå®¢å›­](https://www.cnblogs.com/chanshuyi/p/04_quick_start_of_promql.html)
<sup>2</sup>: [Prometheus å¸¸ç”¨ PromQL è¯­å¥-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘](https://cloud.tencent.com/developer/article/1667913)
<sup>3</sup>: [Prometheus PromQLè¯­æ³• - è¿ç»´äººåœ¨è·¯ä¸Š - åšå®¢å›­](https://www.cnblogs.com/hujinzhong/p/15001755.html)
<sup>4</sup>: [Querying basics | Prometheus](https://prometheus.io/docs/prometheus/latest/querying/basics/)
<sup>5</sup>: [PromQLçš„å¸¸ç”¨æ“ä½œ - æ˜é‡‘](https://juejin.cn/post/7136766432250953742)

å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰å¸®åŠ©ã€‚ğŸ‘

\-
\[1]: [Prometheus å¿«é€Ÿå…¥é—¨æ•™ç¨‹ï¼ˆå››ï¼‰ï¼šPromQL å¿«é€Ÿå…¥é—¨ - é™ˆæ ‘ä¹‰ - åšå®¢å›­](https://www.cnblogs.com/chanshuyi/p/04_quick_start_of_promql.html)
\[2]: [Prometheus å¸¸ç”¨ PromQL è¯­å¥-è…¾è®¯äº‘å¼€å‘è€…ç¤¾åŒº-è…¾è®¯äº‘](https://cloud.tencent.com/developer/article/1667913)
\[3]: [Prometheus PromQLè¯­æ³• - è¿ç»´äººåœ¨è·¯ä¸Š - åšå®¢å›­](https://www.cnblogs.com/hujinzhong/p/15001755.html)
\[4]: [Querying basics | Prometheus](https://prometheus.io/docs/prometheus/latest/querying/basics/)
\[5]: [PromQLçš„å¸¸ç”¨æ“ä½œ - æ˜é‡‘](https://juejin.cn/post/7136766432250953742)

<hr/>

