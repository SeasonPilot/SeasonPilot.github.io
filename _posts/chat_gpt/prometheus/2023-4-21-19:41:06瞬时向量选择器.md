---
layout: post
categories: prometheus
---
Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
ç¬æ—¶å‘é‡é€‰æ‹©å™¨

Answer:

æ‚¨å¥½ï¼Œè¿™æ˜¯Bingã€‚æˆ‘ä¼šç”¨ç®€ä½“ä¸­æ–‡å›å¤æ‚¨ã€‚ğŸ˜Š

ç¬æ—¶å‘é‡é€‰æ‹©å™¨æ˜¯ä¸€ç§PrometheusæŸ¥è¯¢è¯­è¨€ï¼ˆPromQLï¼‰çš„ç‰¹æ€§ï¼Œå®ƒå¯ä»¥æ ¹æ®æ ‡ç­¾å’Œæ—¶é—´èŒƒå›´é€‰æ‹©æ—¶é—´åºåˆ—æ•°æ®<sup>1</sup>ã€‚ç¬æ—¶å‘é‡é€‰æ‹©å™¨çš„è¯­æ³•å¦‚ä¸‹ï¼š

```
<metric_name>[{<label_matchers>}][@<timestamp>]
```

å…¶ä¸­ï¼š

- `<metric_name>`æ˜¯ä¸€ä¸ªå¯é€‰çš„æŒ‡æ ‡åç§°ï¼Œå¦‚æœçœç•¥ï¼Œåˆ™åŒ¹é…æ‰€æœ‰æŒ‡æ ‡ã€‚
- `<label_matchers>`æ˜¯ä¸€ä¸ªå¯é€‰çš„æ ‡ç­¾åŒ¹é…å™¨åˆ—è¡¨ï¼Œç”¨äºè¿‡æ»¤æŒ‡æ ‡ã€‚æ ‡ç­¾åŒ¹é…å™¨æœ‰ä¸‰ç§ç±»å‹ï¼š`=`ï¼ˆç­‰äºï¼‰ã€`!=`ï¼ˆä¸ç­‰äºï¼‰ã€`=~`ï¼ˆæ­£åˆ™åŒ¹é…ï¼‰å’Œ`!~`ï¼ˆæ­£åˆ™ä¸åŒ¹é…ï¼‰ã€‚
- `<timestamp>`æ˜¯ä¸€ä¸ªå¯é€‰çš„æ—¶é—´æˆ³ï¼Œç”¨äºæŒ‡å®šæŸ¥è¯¢çš„æ—¶é—´ç‚¹ã€‚å¦‚æœçœç•¥ï¼Œåˆ™é»˜è®¤ä¸ºå½“å‰æ—¶é—´ã€‚

ä¾‹å¦‚ï¼Œä»¥ä¸‹ç¬æ—¶å‘é‡é€‰æ‹©å™¨å¯ä»¥é€‰æ‹©åœ¨2023å¹´4æœˆ21æ—¥9:54:17 GMT+00:00æ—¶åˆ»ï¼Œæ ‡ç­¾`job`ä¸º`node_exporter`ä¸”æ ‡ç­¾`instance`ä»¥`192.168.`å¼€å¤´çš„æ‰€æœ‰æŒ‡æ ‡ï¼š

```
[{job="node_exporter", instance=~"192.168.*"}]@1621582457
```

ç¬æ—¶å‘é‡é€‰æ‹©å™¨å¯ä»¥ç”¨äºPromQLçš„å‡½æ•°ã€è¿ç®—ç¬¦å’Œèšåˆæ“ä½œä¸­ï¼Œä»¥å¯¹æ—¶é—´åºåˆ—æ•°æ®è¿›è¡Œåˆ†æå’Œå¤„ç†<sup>1</sup>ã€‚

å¦å¤–ï¼Œæœ‰ä¸€ä¸ªé¡¹ç›®å«åšpromql2influxql<sup>2</sup>ï¼Œå®ƒå¯ä»¥å°†PromQLçš„ç¬æ—¶å‘é‡é€‰æ‹©å™¨è½¬æ¢ä¸ºInfluxQLçš„æŸ¥è¯¢è¯­å¥ï¼Œå¹¶æŸ¥è¯¢InfluxDBæ•°æ®åº“è¿”å›ç»“æœã€‚è¿™ä¸ªé¡¹ç›®å¯ä»¥è®©ç”¨æˆ·åœ¨Prometheuså’ŒInfluxDBä¹‹é—´è¿›è¡Œæ— ç¼çš„åˆ‡æ¢å’Œè¿ç§»<sup>2</sup>ã€‚

\-
\[1]: [prometheus-book/prometheus-time-series-selectors.md at master ... - Github](https://github.com/yunlzheng/prometheus-book/blob/master/sources/prometheus-time-series-selectors.md)
\[2]: [wubin1989/promql2influxql - Github](https://github.com/wubin1989/promql2influxql)

<hr/>

Question:

sum(vm_tenant_active_timeseries{job=~"$job", instance=~"$instance"}) by (accountID)

Answer:

è¿™æ˜¯ä¸€ä¸ªPromQLçš„æŸ¥è¯¢è¯­å¥ï¼Œå®ƒå¯ä»¥è®¡ç®—æ¯ä¸ªè´¦æˆ·IDï¼ˆaccountIDï¼‰çš„æ´»è·ƒæ—¶é—´åºåˆ—ï¼ˆvm_tenant_active_timeseriesï¼‰çš„æ€»å’Œï¼Œå…¶ä¸­æŒ‡æ ‡çš„æ ‡ç­¾`job`å’Œ`instance`åˆ†åˆ«åŒ¹é…å˜é‡`$job`å’Œ`$instance`çš„å€¼ã€‚è¿™ä¸ªæŸ¥è¯¢è¯­å¥å¯ä»¥ç”¨äºç›‘æ§å’Œåˆ†æä¸åŒè´¦æˆ·çš„èµ„æºä½¿ç”¨æƒ…å†µã€‚


<hr/>

