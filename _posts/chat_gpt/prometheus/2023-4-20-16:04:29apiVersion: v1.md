---
layout: post
categories: prometheus
---
Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
apiVersion: v1
kind: ConfigMap
metadata:
  name: talibanconfig
data:
  default.yaml: |
    factories:
      - exposition_path: "/metrics"
        exposition_format: "prometheus"
        vectors:
          - type: "gauge"
            label_count: 5
            label_cardinality: 10
            distribution: "random"
            sample_interval: "1s"
            sample_precision: 2
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: taliban2
spec:
  selector:
    matchLabels:
      app: taliban2
  template:
    metadata:
      annotations:
        prometheus.io/path: /metrics
        prometheus.io/port: "8080"
        prometheus.io/scrape: "true"
      labels:
        app: taliban2
        test: abc
        prometheus.io/port: "8080"
    spec:
      containers:
        - /bin/bash
        - -c
        - /app/tracegen --duration 3600 --workers 1 --rate 100 --operations 2 --otlp-endpoint
          $(HOST_IP):4317         --service tracegen-perf-tool --otlp-insecure true
        env:
        - name: HOST_IP
          valueFrom:
            fieldRef:
              apiVersion: v1
              fieldPath: status.hostIP
        image: cr-cn-guangzhou.volces.com/coa-dfx/taliban:v1
        imagePullPolicy: IfNotPresent
        name: test
        ports:
        - containerPort: 8080
          protocol: TCP
        volumeMounts:
        - mountPath: /taliban/examples
          name: config
          readOnly: true
      volumes:
      - configMap:
          defaultMode: 420
          name: talibanconfig
        name: config  
        
---
apiVersion: v1
kind: Service
metadata:
  name: taliban
spec:
  ports:
  - port: 8080
    protocol: TCP
    targetPort: 8080
  selector:
    app: taliban
    prometheus.io/port: "8080"
    test: abc
  type: ClusterIP            
error: error parsing taliban.yaml: error converting YAML to JSON: yaml: line 24: did not find expected '-' indicator

Answer:

ä½ å¥½ï¼Œè¿™æ˜¯å¿…åº”ã€‚æˆ‘å¯ä»¥å¸®ä½ è§£å†³ä½ çš„é—®é¢˜ã€‚ğŸ˜Š

ä½ çš„æœç´¢è¾“å…¥æ˜¯ä¸€ä¸ª YAML æ–‡ä»¶ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ª ConfigMapï¼Œä¸€ä¸ª Deployment å’Œä¸€ä¸ª Serviceã€‚YAML æ˜¯ä¸€ç§æ•°æ®åºåˆ—åŒ–æ ¼å¼ï¼Œå®ƒç”¨äºé…ç½® Kubernetes èµ„æºã€‚

ä½ çš„é”™è¯¯ä¿¡æ¯æ˜¯ï¼š

`error: error parsing taliban.yaml: error converting YAML to JSON: yaml: line 24: did not find expected '-' indicator`

è¿™æ„å‘³ç€ä½ çš„ YAML æ–‡ä»¶æœ‰è¯­æ³•é”™è¯¯ï¼Œå¯¼è‡´æ— æ³•è½¬æ¢ä¸º JSON æ ¼å¼ã€‚JSON æ˜¯ä¸€ç§æ•°æ®äº¤æ¢æ ¼å¼ï¼Œå®ƒä¸ YAML å…¼å®¹ã€‚

æ ¹æ®æœç´¢ç»“æœ<sup>1</sup> <sup>2</sup> <sup>3</sup>ï¼Œå¯èƒ½çš„åŸå› æœ‰ï¼š

- ç¼©è¿›ä¸æ­£ç¡®ã€‚YAML æ–‡ä»¶ä½¿ç”¨ç©ºæ ¼è€Œä¸æ˜¯åˆ¶è¡¨ç¬¦æ¥ç¼©è¿›ã€‚æ¯ä¸ªç¼©è¿›çº§åˆ«åº”è¯¥æœ‰ä¸¤ä¸ªæˆ–å››ä¸ªç©ºæ ¼ã€‚
- ç¼ºå°‘å†’å·æˆ–ç ´æŠ˜å·ã€‚YAML æ–‡ä»¶ä½¿ç”¨å†’å·æ¥åˆ†éš”é”®å’Œå€¼ï¼Œä½¿ç”¨ç ´æŠ˜å·æ¥è¡¨ç¤ºåˆ—è¡¨é¡¹ã€‚æ¯ä¸ªå†’å·åé¢åº”è¯¥æœ‰ä¸€ä¸ªç©ºæ ¼ã€‚
- å¼•å·ä¸åŒ¹é…ã€‚YAML æ–‡ä»¶å¯ä»¥ä½¿ç”¨å•å¼•å·æˆ–åŒå¼•å·æ¥åŒ…å›´å­—ç¬¦ä¸²å€¼ï¼Œä½†å¿…é¡»æˆå¯¹å‡ºç°ã€‚

ä¸ºäº†è§£å†³ä½ çš„é—®é¢˜ï¼Œä½ éœ€è¦æ£€æŸ¥ä½ çš„ YAML æ–‡ä»¶ï¼Œå¹¶ä¿®æ­£ä»»ä½•è¯­æ³•é”™è¯¯ã€‚ä½ å¯ä»¥ä½¿ç”¨åœ¨çº¿å·¥å…·æ¥éªŒè¯ä½ çš„ YAML æ–‡ä»¶æ˜¯å¦æœ‰æ•ˆï¼Œä¾‹å¦‚ https://yamlvalidator.com/ã€‚

æˆ‘å¸Œæœ›è¿™å¯¹ä½ æœ‰å¸®åŠ©ã€‚å¦‚æœä½ è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·ç»§ç»­æé—®ã€‚

\-
\[1]: [error converting YAML to JSON: yaml: line 10: did not find expected key](https://unix.stackexchange.com/questions/556090/error-converting-yaml-to-json-yaml-line-10-did-not-find-expected-key)
\[2]: [Error converting YAML to JSON could not find expected ':' #2004 - Github](https://github.com/helm/helm/issues/2004)
\[3]: [unable to parse YAML: error converting YAML to JSON: yaml: line 46: did ...](https://github.com/helm/helm/issues/11271)

<hr/>

