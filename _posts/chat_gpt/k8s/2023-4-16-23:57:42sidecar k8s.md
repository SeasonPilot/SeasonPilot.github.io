---
layout: post
categories: k8s
---
Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
sidecar k8s

Answer:

æ‚¨å¥½ï¼Œè¿™æ˜¯å¿…åº”ã€‚æ‚¨çš„æœç´¢è¾“å…¥æ˜¯ sidecar k8sã€‚æˆ‘å°†å°½é‡æä¾›ä¸ä¹‹ç›¸å…³çš„æœ‰ç”¨å†…å®¹æˆ–è§£å†³æ–¹æ¡ˆï¼Œå¹¶å°½å¯èƒ½å¤šåœ°æä¾›ä¿¡æ¯ã€‚æˆ‘å°†ä½¿ç”¨ markdown è¯­æ³•æ¥ä½¿æˆ‘çš„å›ç­”æ›´æ˜“è¯»ï¼Œä¾‹å¦‚ä»£ç å—ã€ç²—ä½“ã€åˆ—è¡¨ç­‰ã€‚

sidecar k8s æ˜¯æŒ‡åœ¨ Kubernetes ä¸­ä½¿ç”¨ sidecar æ¨¡å¼çš„ä¸€ç§å¾®æœåŠ¡æ¶æ„ã€‚sidecar æ¨¡å¼æ˜¯æŒ‡åœ¨ä¸€ä¸ª pod ä¸­è¿è¡Œä¸€ä¸ªæˆ–å¤šä¸ªè¾…åŠ©å®¹å™¨ï¼Œä»¥å¢å¼ºæˆ–æ‰©å±•ä¸»åº”ç”¨å®¹å™¨çš„åŠŸèƒ½ã€‚pod æ˜¯ Kubernetes ä¸­çš„ä¸€ä¸ªåŸºæœ¬æ¦‚å¿µï¼Œå®ƒæ˜¯ä¸€ç»„å…·æœ‰å…±äº«å­˜å‚¨å’Œç½‘ç»œçš„ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨ã€‚

sidecar å®¹å™¨å¯ä»¥ç”¨äºå®ç°å„ç§åŠŸèƒ½ï¼Œä¾‹å¦‚æ—¥å¿—æ”¶é›†ã€ç›‘æ§ã€é…ç½®ç®¡ç†ã€æœåŠ¡å‘ç°ç­‰ã€‚sidecar å®¹å™¨ä¸ä¸»åº”ç”¨å®¹å™¨æ¾æ•£è€¦åˆï¼Œå¯ä»¥ç‹¬ç«‹æ›´æ–°å’Œç»´æŠ¤ã€‚

è¦åœ¨ Kubernetes ä¸­ä½¿ç”¨ sidecar å®¹å™¨ï¼Œéœ€è¦åœ¨ pod çš„å®šä¹‰æ–‡ä»¶ä¸­æŒ‡å®šå¤šä¸ªå®¹å™¨ï¼Œå¹¶ä¸ºå®ƒä»¬åˆ†é…å…±äº«çš„å·ã€ç«¯å£ã€ç¯å¢ƒå˜é‡ç­‰ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œå±•ç¤ºäº†ä¸€ä¸ª pod ä¸­åŒ…å«ä¸€ä¸ª nginx åº”ç”¨å®¹å™¨å’Œä¸€ä¸ª sidecar å®¹å™¨ï¼Œåè€…ç”¨äºä»åº”ç”¨å®¹å™¨ä¸­æå–æ—¥å¿—å¹¶å‘é€åˆ°è¿œç¨‹æœåŠ¡å™¨ã€‚

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: nginx-sidecar
spec:
  volumes:
  - name: shared-logs
    emptyDir: {}
  containers:
  - name: nginx
    image: nginx
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log/nginx
  - name: sidecar
    image: containiq/logstash-sidecar-example
    env:
    - name: LOGSTASH_HOST
      value: "logstash.example.com"
    volumeMounts:
    - name: shared-logs
      mountPath: /var/log/nginx
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œä¸¤ä¸ªå®¹å™¨éƒ½æŒ‚è½½äº†ä¸€ä¸ªåä¸º shared-logs çš„å·ï¼Œç”¨äºå­˜å‚¨ nginx çš„æ—¥å¿—æ–‡ä»¶ã€‚sidecar å®¹å™¨ä½¿ç”¨äº†ä¸€ä¸ªåä¸º containiq/logstash-sidecar-example çš„é•œåƒï¼Œå®ƒåŒ…å«äº†ä¸€ä¸ª logstash è¿›ç¨‹ï¼Œç”¨äºè¯»å–æ—¥å¿—æ–‡ä»¶å¹¶å‘é€åˆ°ç¯å¢ƒå˜é‡ LOGSTASH_HOST æŒ‡å®šçš„åœ°å€ã€‚

é™¤äº†ä¸Šé¢çš„ä¾‹å­å¤–ï¼Œè¿˜æœ‰è®¸å¤šå…¶ä»–çš„ sidecar å®¹å™¨çš„åº”ç”¨åœºæ™¯å’Œå®ç°æ–¹å¼ã€‚ä¾‹å¦‚ï¼š

- ä½¿ç”¨ vault-k8s å·¥å…·æ¥æ³¨å…¥ Vault çš„å¯†é’¥åˆ° Kubernetes çš„ pod ä¸­ã€‚
- ä½¿ç”¨ k8s-sidecar å®¹å™¨æ¥æ”¶é›†å¸¦æœ‰ç‰¹å®šæ ‡ç­¾çš„ config mapsï¼Œå¹¶å°†å…¶ä¸­çš„æ–‡ä»¶å­˜å‚¨åœ¨æœ¬åœ°æ–‡ä»¶å¤¹ä¸­ã€‚
- ä½¿ç”¨ logrotate å®¹å™¨æ¥å®šæœŸè½®æ¢æ— æ³•ç”±åº”ç”¨æœ¬èº«è½®æ¢çš„æ—¥å¿—æ–‡ä»¶ã€‚
- ä½¿ç”¨ Learnk8s çš„ sidecar å®¹å™¨æ¥å®ç°æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ã€‚

å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰æ‰€å¸®åŠ©ã€‚å¦‚æœæ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜æˆ–æƒ³è¦æ›´å¤šç»†èŠ‚ï¼Œè¯·éšæ—¶å‘Šè¯‰æˆ‘ã€‚ğŸ˜Š


<hr/>

