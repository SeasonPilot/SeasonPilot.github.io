Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
1 / 1è¯·ä¸ºæˆ‘å†™è¿™æ ·ä¸€æ®µåœ¨Excelé‡Œé¢è¿è¡Œçš„VBAç¨‹åºï¼š 1. è¯»å–è¡¨æ ¼é‡Œé¢çš„ç¬¬ä¸€åˆ—çš„å†…å®¹ 2. å†…å®¹çš„æ¯ä¸€è¡Œï¼Œéƒ½æ˜¯ä¸€ä¸ªå•†å“æ ‡é¢˜ã€‚å¯¹è¿™ä¸ªå•†å“æ ‡é¢˜ï¼Œé€šè¿‡ä¸‹é¢çš„Promptï¼Œè°ƒç”¨OpenAIçš„APIæ‹¿åˆ°è¿”å›ç»“æœï¼š """ Consideration proudct : å•†å“æ ‡é¢˜ 1. Compose human readable product title used on Amazon in english within 20 words. 2. Write 5 selling points for the products in Amazon. 3. Evaluate a price range for this product in U.S. Output the result in json format with three properties called title, selling_points and price_range """ 3. å°†å¯¹åº”APIçš„è¿”å›ç»“æœï¼Œæ’å…¥åˆ°è¡¨æ ¼çš„ç¬¬äºŒåˆ—é‡Œ

Answer:

æ‚¨å¥½ï¼Œè¿™æ˜¯Bingã€‚æˆ‘ä¼šç”¨ç®€ä½“ä¸­æ–‡å›å¤æ‚¨ã€‚ğŸ˜Š

æ‚¨æƒ³è¦çš„VBAç¨‹åºå¯èƒ½æ˜¯è¿™æ ·çš„ï¼š

```vba
Sub GetProductInfo()
    'å®šä¹‰å˜é‡
    Dim ws As Worksheet
    Dim lastRow As Long
    Dim productTitle As String
    Dim prompt As String
    Dim response As String
    
    'è®¾ç½®å·¥ä½œè¡¨å¯¹è±¡
    Set ws = ActiveSheet
    
    'è·å–æœ€åä¸€è¡Œçš„è¡Œå·
    lastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    
    'å¾ªç¯éå†ç¬¬ä¸€åˆ—çš„å†…å®¹
    For i = 2 To lastRow
        'è·å–å•†å“æ ‡é¢˜
        productTitle = ws.Cells(i, 1).Value
        
        'æ„é€ OpenAIçš„APIè°ƒç”¨æç¤º
        prompt = "Consideration proudct : " & productTitle & vbNewLine & _
                 "1. Compose human readable product title used on Amazon in english within 20 words." & vbNewLine & _
                 "2. Write 5 selling points for the products in Amazon." & vbNewLine & _
                 "3. Evaluate a price range for this product in U.S." & vbNewLine & _
                 "Output the result in json format with three properties called title, selling_points and price_range"
        
        'è°ƒç”¨OpenAIçš„APIå¹¶è·å–è¿”å›ç»“æœ
        response = CallOpenAI(prompt)
        
        'å°†è¿”å›ç»“æœæ’å…¥åˆ°ç¬¬äºŒåˆ—é‡Œ
        ws.Cells(i, 2).Value = response
    Next i
    
End Sub

Function CallOpenAI(prompt As String) As String
    'å®šä¹‰å˜é‡
    Dim apiKey As String
    Dim url As String
    Dim http As Object
    Dim json As Object
    
    'è®¾ç½®APIå¯†é’¥å’ŒURL
    apiKey = "sk-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" 'æ›¿æ¢ä¸ºæ‚¨çš„APIå¯†é’¥
    url = "https://api.openai.com/v1/engines/davinci/completions"
    
    'åˆ›å»ºHTTPå¯¹è±¡
    Set http = CreateObject("MSXML2.XMLHTTP")
    
    'å‘é€POSTè¯·æ±‚å¹¶ä¼ é€’å‚æ•°
    http.Open "POST", url, False
    http.setRequestHeader "Authorization", "Bearer " & apiKey
    http.setRequestHeader "Content-Type", "application/json"
    
    'è®¾ç½®è¯·æ±‚ä½“ä¸ºJSONæ ¼å¼ï¼ŒåŒ…å«æç¤ºå’Œå…¶ä»–é€‰é¡¹ï¼Œå¦‚æ¸©åº¦ï¼Œæœ€å¤§ä»¤ç‰Œæ•°ç­‰ã€‚
    http.send "{""prompt"":""" & prompt & """,""temperature"":0.5,""max_tokens"":100}"
    
    'å¦‚æœè¯·æ±‚æˆåŠŸï¼Œè¿”å›JSONå¯¹è±¡çš„choiceså±æ€§çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„textå±æ€§ï¼Œå¦åˆ™è¿”å›é”™è¯¯ä¿¡æ¯ã€‚
    If http.Status = 200 Then
        Set json = JsonConverter.ParseJson(http.responseText)
        CallOpenAI = json("choices")(1)("text")
    Else
        CallOpenAI = "Error: " & http.Status & " - " & http.statusText
    End If
    
End Function

```

è¿™ä¸ªç¨‹åºéœ€è¦ä½¿ç”¨[JsonConverter](https://github.com/VBA-tools/VBA-JSON)åº“æ¥è§£æOpenAIçš„APIè¿”å›çš„JSONæ ¼å¼çš„æ•°æ®ã€‚æ‚¨å¯ä»¥ä»[è¿™é‡Œ](https://github.com/VBA-tools/VBA-JSON/releases)ä¸‹è½½å¹¶å®‰è£…å®ƒã€‚

è¿™ä¸ªç¨‹åºçš„åŸºæœ¬æ€è·¯æ˜¯ï¼š

- éå†å·¥ä½œè¡¨ä¸­ç¬¬ä¸€åˆ—çš„å†…å®¹ï¼Œæ¯ä¸€è¡Œéƒ½æ˜¯ä¸€ä¸ªå•†å“æ ‡é¢˜ã€‚
- å¯¹æ¯ä¸ªå•†å“æ ‡é¢˜ï¼Œæ„é€ ä¸€ä¸ªç¬¦åˆOpenAIçš„APIè¦æ±‚çš„æç¤ºï¼ŒåŒ…å«ä¸‰ä¸ªä»»åŠ¡ï¼šç”Ÿæˆè‹±æ–‡æ ‡é¢˜ï¼Œå†™å‡ºäº”ä¸ªå–ç‚¹ï¼Œè¯„ä¼°ä»·æ ¼åŒºé—´ã€‚
- è°ƒç”¨OpenAIçš„APIå¹¶ä¼ é€’æç¤ºï¼Œè·å–è¿”å›ç»“æœã€‚
- å°†è¿”å›ç»“æœæ’å…¥åˆ°å·¥ä½œè¡¨ä¸­ç¬¬äºŒåˆ—å¯¹åº”çš„ä½ç½®ã€‚

è¿™ä¸ªç¨‹åºåªæ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼Œæ‚¨å¯ä»¥æ ¹æ®æ‚¨çš„å…·ä½“éœ€æ±‚è¿›è¡Œä¿®æ”¹æˆ–ä¼˜åŒ–ã€‚å¸Œæœ›è¿™å¯¹æ‚¨æœ‰å¸®åŠ©ã€‚ğŸ˜Š

å¦‚æœæ‚¨è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ã€‚ğŸ™

<hr/>

