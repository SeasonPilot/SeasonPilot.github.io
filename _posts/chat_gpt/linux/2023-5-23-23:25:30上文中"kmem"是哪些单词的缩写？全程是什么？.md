---
layout: post
categories: linux
---
Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
```
if (!(epi = kmem_cache_alloc(epi_cache, GFP_KERNEL)))
        return -ENOMEM;
    /* Item initialization follow here ... */
     INIT_LIST_HEAD(&epi->rdllink);
    INIT_LIST_HEAD(&epi->fllink);
    INIT_LIST_HEAD(&epi->pwqlist);
    epi->ep = ep;
    ep_set_ffd(&epi->ffd, tfile, fd);
    epi->event = *event;
    epi->nwait = 0;
    epi->next = EP_UNACTIVE_PTR;
```

Answer:

æ‚¨å¥½ï¼Œè¿™æ˜¯å¿…åº”ã€‚æˆ‘ä¼šç”¨ç®€ä½“ä¸­æ–‡å›å¤æ‚¨ã€‚ğŸ˜Š

æ‚¨çš„æœç´¢è¾“å…¥æ˜¯ä¸€æ®µ Linux å†…æ ¸ä¸­ä½¿ç”¨ epoll çš„ä»£ç ã€‚epoll æ˜¯ä¸€ç§é«˜æ•ˆçš„ I/O å¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œå¯ä»¥åœ¨å¤§é‡æ–‡ä»¶æè¿°ç¬¦ä¸Šç›‘å¬äº‹ä»¶ã€‚ä»£ç ä¸­çš„ kmem_cache_alloc å‡½æ•°æ˜¯ä¸€ç§å†…å­˜åˆ†é…å‡½æ•°ï¼Œå®ƒä»ä¸€ä¸ªé¢„å…ˆåˆ›å»ºçš„å†…å­˜ç¼“å­˜ï¼ˆkmem_cacheï¼‰ä¸­åˆ†é…ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™æ ·å¯ä»¥æé«˜å†…å­˜åˆ†é…çš„é€Ÿåº¦å’Œæ•ˆç‡<sup>1</sup> <sup>2</sup>ã€‚

ä»£ç ä¸­çš„ epi æ˜¯ä¸€ä¸ª epoll_item ç»“æ„ä½“çš„æŒ‡é’ˆï¼Œå®ƒè¡¨ç¤ºä¸€ä¸ªè¢«ç›‘å¬çš„æ–‡ä»¶æè¿°ç¬¦åŠå…¶ç›¸å…³çš„äº‹ä»¶å’Œæ•°æ®ã€‚ä»£ç ä¸­åˆå§‹åŒ–äº† epi çš„å„ä¸ªå­—æ®µï¼ŒåŒ…æ‹¬ï¼š

- epi->rdllinkï¼šä¸€ä¸ªé“¾è¡¨å¤´ï¼Œç”¨äºå°† epi æ’å…¥åˆ° epoll å®ä¾‹çš„å°±ç»ªåˆ—è¡¨ä¸­ã€‚
- epi->fllinkï¼šä¸€ä¸ªé“¾è¡¨å¤´ï¼Œç”¨äºå°† epi æ’å…¥åˆ°æ–‡ä»¶æè¿°ç¬¦çš„ç›‘å¬åˆ—è¡¨ä¸­ã€‚
- epi->pwqlistï¼šä¸€ä¸ªé“¾è¡¨å¤´ï¼Œç”¨äºå°† epi å…³è”çš„ epoll_wait_queue ç»“æ„ä½“æ’å…¥åˆ°ä¸€ä¸ªåˆ—è¡¨ä¸­ï¼Œè¿™äº›ç»“æ„ä½“è¡¨ç¤ºç­‰å¾…è¯¥ epi å°±ç»ªçš„è¿›ç¨‹ã€‚
- epi->epï¼šä¸€ä¸ªæŒ‡å‘ epoll å®ä¾‹çš„æŒ‡é’ˆã€‚
- epi->ffdï¼šä¸€ä¸ªå°è£…äº†æ–‡ä»¶æè¿°ç¬¦å’Œæ–‡ä»¶æŒ‡é’ˆçš„ç»“æ„ä½“ã€‚
- epi->eventï¼šä¸€ä¸ª epoll_event ç»“æ„ä½“ï¼Œè¡¨ç¤ºè¦ç›‘å¬çš„äº‹ä»¶ç±»å‹å’Œç”¨æˆ·æ•°æ®ã€‚
- epi->nwaitï¼šä¸€ä¸ªè®¡æ•°å™¨ï¼Œè¡¨ç¤ºæœ‰å¤šå°‘ä¸ªè¿›ç¨‹åœ¨ç­‰å¾…è¯¥ epi å°±ç»ªã€‚
- epi->nextï¼šä¸€ä¸ªæŒ‡é’ˆï¼Œç”¨äºå°† epi æ’å…¥åˆ°ä¸€ä¸ªåŒå‘é“¾è¡¨ä¸­ï¼Œè¿™ä¸ªé“¾è¡¨ç”¨äºå­˜å‚¨å°±ç»ªæˆ–æœªæ¿€æ´»çš„ epiã€‚

æ‚¨æƒ³äº†è§£æ›´å¤šå…³äº epoll æˆ– kmem_cache_alloc çš„ä¿¡æ¯å—ï¼Ÿå¦‚æœæ˜¯ï¼Œè¯·å‘Šè¯‰æˆ‘æ‚¨æ„Ÿå…´è¶£çš„æ–¹é¢æˆ–é—®é¢˜ã€‚ğŸ‘

\-
\[1]: [Memory Management APIs â€” The Linux Kernel documentation](https://www.kernel.org/doc/html/latest/core-api/mm-api.html?highlight=kmem_cache_alloc)
\[2]: [Memory Allocation Guide â€” The Linux Kernel documentation](https://docs.kernel.org/core-api/memory-allocation.html)
\[3]: [Kernel Memory Leak Detector â€” The Linux Kernel documentation](https://www.kernel.org/doc/html/latest/dev-tools/kmemleak.html)

<hr/>

Question:

ä¸Šæ–‡ä¸­"rdllink, fllink, pwqlist"æ˜¯å“ªäº›å•è¯çš„ç¼©å†™ï¼Ÿå…¨ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ

Answer:

ä¸Šæ–‡ä¸­çš„ rdllink, fllink, pwqlist æ˜¯ä»¥ä¸‹å•è¯çš„ç¼©å†™ï¼š

- rdllinkï¼šready list linkï¼Œå°±ç»ªåˆ—è¡¨é“¾æ¥ã€‚
- fllinkï¼šfile list linkï¼Œæ–‡ä»¶åˆ—è¡¨é“¾æ¥ã€‚
- pwqlistï¼špoll wait queue listï¼Œè½®è¯¢ç­‰å¾…é˜Ÿåˆ—åˆ—è¡¨ã€‚

è¿™äº›éƒ½æ˜¯ Linux å†…æ ¸ä¸­çš„å‘½åçº¦å®šï¼Œç”¨äºè¡¨ç¤ºé“¾è¡¨å¤´ç»“æ„ä½“ã€‚ğŸ‘Œ


<hr/>

Question:

ä¸Šæ–‡ä¸­"kmem"æ˜¯å“ªäº›å•è¯çš„ç¼©å†™ï¼Ÿå…¨ç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ

Answer:

ä¸Šæ–‡ä¸­çš„ kmem æ˜¯ kernel memory çš„ç¼©å†™ï¼Œè¡¨ç¤ºå†…æ ¸å†…å­˜ã€‚kmem_cache æ˜¯ä¸€ç§å†…æ ¸å†…å­˜ç¼“å­˜ï¼Œç”¨äºå­˜å‚¨å¤§å°å’Œç±»å‹ç›¸åŒçš„å¯¹è±¡ï¼Œä»¥ä¾¿å¿«é€Ÿåˆ†é…å’Œå›æ”¶ã€‚ğŸ˜Š


<hr/>

