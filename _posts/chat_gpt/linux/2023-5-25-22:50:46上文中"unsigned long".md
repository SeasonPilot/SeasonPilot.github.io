---
layout: post
categories: linux
---
Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
if (key && !((unsigned long) key & epi->event.events)) goto out_unlock;

Answer:

æ‚¨å¥½ï¼Œè¿™æ˜¯å¿…åº”ã€‚æˆ‘ä¼šç”¨ç®€ä½“ä¸­æ–‡å›å¤æ‚¨ã€‚

è¿™æ˜¯ä¸€æ®µCè¯­è¨€çš„ä»£ç ï¼Œç”¨äºepollçš„å®ç°ã€‚epollæ˜¯ä¸€ç§é«˜æ•ˆçš„I/Oå¤šè·¯å¤ç”¨æœºåˆ¶ï¼Œå¯ä»¥åœ¨Linuxç³»ç»Ÿä¸­ç›‘æ§å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦çš„äº‹ä»¶ã€‚<sup>1</sup>

è¿™æ®µä»£ç çš„æ„æ€æ˜¯ï¼š

- å¦‚æœkeyä¸ä¸ºç©ºï¼Œå¹¶ä¸”keyä¸epi->event.eventsçš„æŒ‰ä½ä¸è¿ç®—ç»“æœä¸ºé›¶ï¼Œå°±è·³è½¬åˆ°out_unlockæ ‡ç­¾å¤„ã€‚<sup>5</sup>
- è¿™ä¸ªæ¡ä»¶å¯èƒ½æ˜¯ç”±äºEPOLLONESHOTä½çš„å½±å“ï¼Œå®ƒä¼šåœ¨æ”¶åˆ°ä¸€ä¸ªäº‹ä»¶åç¦ç”¨æ–‡ä»¶æè¿°ç¬¦ï¼Œç›´åˆ°ä¸‹ä¸€æ¬¡EPOLL_CTL_MODæ“ä½œã€‚<sup>2</sup>
- out_unlockæ ‡ç­¾å¤„çš„ä»£ç ä¼šè§£é”epi->lockï¼Œå¹¶å”¤é†’ç­‰å¾…åœ¨epi->waité˜Ÿåˆ—ä¸Šçš„è¿›ç¨‹ã€‚<sup>6</sup>

å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äºepollçš„å®ç°ç»†èŠ‚ï¼Œæ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹ç½‘å€ï¼š

- <sup>1</sup> https://idndx.com/the-implementation-of-epoll-3/
- <sup>2</sup> https://www.programminghunter.com/article/42771059515/
- <sup>3</sup> https://codeantenna.com/a/oW3HkvfPgR
- <sup>4</sup> https://github.com/torvalds/linux/blob/master/fs/eventpoll.c
- <sup>5</sup> https://github.com/grasslog/Epoll/blob/master/ep_poll_callback
- <sup>6</sup> https://cpp.hotexamples.com/examples/-/-/wake_up_locked/cpp-wake_up_locked-function-examples.html

å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰å¸®åŠ©ã€‚ğŸ˜Š

\-
\[1]: [The Implementation of epoll (3) - Datong's Random Thoughts](https://idndx.com/the-implementation-of-epoll-3/)
\[2]: [Epoll/ep_poll_callback at master Â· grasslog/Epoll Â· GitHub](https://github.com/grasslog/Epoll/blob/master/ep_poll_callback)
\[3]: [epoll oneshot - ç¼–ç¨‹çŒäºº](https://www.programminghunter.com/article/42771059515/)
\[4]: [C++ (Cpp) wake_up_locked Examples - HotExamples](https://cpp.hotexamples.com/examples/-/-/wake_up_locked/cpp-wake_up_locked-function-examples.html)
\[5]: [epollçš„å®ç°åŸç†ï¼ˆ2ï¼‰ - CodeAntenna](https://codeantenna.com/a/oW3HkvfPgR)
\[6]: [linux/eventpoll.c at master Â· torvalds/linux Â· GitHub](https://github.com/torvalds/linux/blob/master/fs/eventpoll.c)

<hr/>

Question:

ä¸Šæ–‡ä¸­"unsigned long"

Answer:

unsigned longæ˜¯ä¸€ç§æ•°æ®ç±»å‹ï¼Œç”¨äºå­˜å‚¨æ— ç¬¦å·çš„é•¿æ•´æ•°ï¼Œå ç”¨32ä½ï¼ˆ4å­—èŠ‚ï¼‰ã€‚å®ƒçš„å–å€¼èŒƒå›´æ˜¯ä»0åˆ°4,294,967,295ï¼ˆ2^32 - 1ï¼‰ã€‚<sup>1</sup> <sup>2</sup> <sup>3</sup>

ä¸ä¹‹ç›¸å¯¹çš„æ˜¯signed longï¼Œå®ƒå¯ä»¥å­˜å‚¨æœ‰ç¬¦å·çš„é•¿æ•´æ•°ï¼Œå ç”¨32ä½ï¼ˆ4å­—èŠ‚ï¼‰ã€‚å®ƒçš„å–å€¼èŒƒå›´æ˜¯ä»-2,147,483,647åˆ°+2,147,483,647ï¼ˆ-2^31åˆ°+2^31 - 1ï¼‰ã€‚<sup>4</sup>

åœ¨C/C++ä¸­ï¼Œè¿˜æœ‰å…¶ä»–çš„æ•°æ®ç±»å‹ï¼Œå¦‚shortã€intã€long longç­‰ï¼Œå®ƒä»¬çš„å¤§å°å’Œè¡¨ç¤ºæ–¹å¼å¯èƒ½å–å†³äºç¼–è¯‘å™¨å’Œå¹³å°ã€‚<sup>5</sup>

å¦‚æœæ‚¨æƒ³äº†è§£æ›´å¤šå…³äºæ•°æ®ç±»å‹çš„çŸ¥è¯†ï¼Œæ‚¨å¯ä»¥å‚è€ƒä»¥ä¸‹ç½‘å€ï¼š

- <sup>1</sup> https://reference.arduino.cc/reference/en/language/variables/data-types/unsignedlong/
- <sup>2</sup> https://arduinogetstarted.com/reference/arduino-unsigned-long
- <sup>3</sup> https://en.wikipedia.org/wiki/C_data_types
- <sup>4</sup> https://stackoverflow.com/questions/2550345/whats-the-difference-between-unsigned-long-long-int-in-c-c
- <sup>5</sup> https://en.cppreference.com/w/cpp/language/types

å¸Œæœ›è¿™äº›ä¿¡æ¯å¯¹æ‚¨æœ‰å¸®åŠ©ã€‚ğŸ˜Š

\-
\[1]: [unsigned long - Arduino Reference](https://reference.arduino.cc/reference/en/language/variables/data-types/unsignedlong/)
\[2]: [unsigned long | Arduino Reference](https://arduinogetstarted.com/reference/arduino-unsigned-long)
\[3]: [C data types - Wikipedia](https://en.wikipedia.org/wiki/C_data_types)
\[4]: [What's the difference between unsigned long/long/int in c/c++?](https://stackoverflow.com/questions/2550345/whats-the-difference-between-unsigned-long-long-int-in-c-c)
\[5]: [Fundamental types - cppreference.com](https://en.cppreference.com/w/cpp/language/types)

<hr/>

