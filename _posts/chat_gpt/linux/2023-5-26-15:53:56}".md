---
layout: post
categories: linux
---
Question:

Reply in Chinese (Simplified).Explain the following code:
"//è¿™é‡Œæ˜¯Level-triggeredçš„å¤„ç†ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œåœ¨Level-triggeredçš„æƒ…å†µä¸‹ï¼Œè¿™ä¸ªäº‹ä»¶è¢«é‡æ–°åŠ å›åˆ°ready listé‡Œé¢
//è¿™æ ·ï¼Œä¸‹ä¸€è½®epoll_waitçš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šè¢«é‡æ–°check
else if (!(epi->event.events & EPOLLET)) {
    /*
     * If this file has been added with Level
     * Trigger mode, we need to insert back inside
     * the ready list, so that the next call to
     * epoll_wait() will check again the events
     * availability. At this point, no one can insert
     * into ep->rdllist besides us. The epoll_ctl()
     * callers are locked out by
     * ep_scan_ready_list() holding "mtx" and the
     * poll callback will queue them in ep->ovflist.
     */
    list_add_tail(&epi->rdllink, &ep->rdllist);
    ep_pm_stay_awake(epi);
}"

Answer:

æ‚¨å¥½ï¼Œè¿™æ˜¯Bingã€‚æˆ‘å¯ä»¥ç”¨ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰å›å¤æ‚¨ã€‚ğŸ˜Š

è¿™æ®µä»£ç æ˜¯ç”¨Cè¯­è¨€å†™çš„ï¼Œæ˜¯å…³äºepollçš„ä¸€ä¸ªåŠŸèƒ½ã€‚epollæ˜¯Linuxç³»ç»Ÿä¸­çš„ä¸€ç§é«˜æ•ˆçš„å¤šè·¯å¤ç”¨I/Oæœºåˆ¶ï¼Œå¯ä»¥ç›‘è§†å¤šä¸ªæ–‡ä»¶æè¿°ç¬¦ï¼Œçœ‹æ˜¯å¦æœ‰I/Oæ“ä½œå¯ä»¥è¿›è¡Œ<sup>4</sup>ã€‚

è¿™æ®µä»£ç ä¸­ï¼Œæ³¨é‡Šè¯´æ˜äº†è¿™é‡Œæ˜¯ä½¿ç”¨Level-triggeredæ¨¡å¼çš„å¤„ç†ã€‚Level-triggeredæ¨¡å¼æ˜¯epollçš„é»˜è®¤æ¨¡å¼ï¼Œå®ƒçš„å«ä¹‰æ˜¯åªè¦æ–‡ä»¶æè¿°ç¬¦ä¸Šæœ‰æ•°æ®ï¼Œå°±ä¼šè§¦å‘epolläº‹ä»¶<sup>2</sup> <sup>3</sup>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œepoll_wait()å‡½æ•°ä¼šè¿”å›æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„æ–‡ä»¶æè¿°ç¬¦<sup>1</sup>ã€‚

æ‰€ä»¥ï¼Œåœ¨è¿™æ®µä»£ç ä¸­ï¼Œå¦‚æœäº‹ä»¶æ²¡æœ‰è®¾ç½®EPOLLETæ ‡å¿—ï¼ˆè¡¨ç¤ºä½¿ç”¨Level-triggeredæ¨¡å¼ï¼‰ï¼Œé‚£ä¹ˆå°±ä¼šæŠŠè¿™ä¸ªäº‹ä»¶é‡æ–°åŠ å…¥åˆ°ready listé‡Œé¢ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡è°ƒç”¨epoll_wait()çš„æ—¶å€™ï¼Œè¿™ä¸ªäº‹ä»¶ä¼šè¢«é‡æ–°æ£€æŸ¥æ˜¯å¦æœ‰æ•°æ®å¯è¯»æˆ–å¯å†™<sup>5</sup>ã€‚

æ‚¨å¯¹epollæœ‰ä»€ä¹ˆå…¶ä»–é—®é¢˜å—ï¼ŸğŸ¤”

\-
\[1]: [epoll(7) - Linux manual page - man7.org](https://man7.org/linux/man-pages/man7/epoll.7.html)
\[2]: [When to use epoll as a level triggered interface?](https://itexpertly.com/when-to-use-epoll-as-a-level-triggered-interface/)
\[3]: [epoll - What does level triggered and edge triggered mean? - Google Groups](https://groups.google.com/g/comp.unix.programmer/c/g0fp00DvznE)
\[4]: [How do we know whether call to epoll_wait() is edge triggered or level ...](https://stackoverflow.com/questions/24400941/how-do-we-know-whether-call-to-epoll-wait-is-edge-triggered-or-level-triggered)
\[5]: [linux - epoll: difference between level triggered and edge triggered ...](https://stackoverflow.com/questions/46621209/epoll-difference-between-level-triggered-and-edge-triggered-when-epolloneshot-s)

<hr/>

