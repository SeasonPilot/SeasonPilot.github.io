Question:

Reply in Chinese (Simplified).
The following is a search input in a search engine, giving useful content or solutions and as much information as you can related to it, use markdown syntax to make your answer more readable, such as code blocks, bold, list:
ThreadLocal å¦‚ä½•ä½¿ç”¨ï¼Ÿè¯·ä¸¾ä¾‹è¯´æ˜ï¼Œå¹¶ç»™å‡ºç¤ºä¾‹ä»£ç 

Answer:

`ThreadLocal` æ˜¯ Java ä¸­çš„ä¸€ä¸ªç±»ï¼Œç”¨äºåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å­˜å‚¨çº¿ç¨‹æœ¬åœ°å˜é‡ã€‚å®ƒå…è®¸ä½ ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„å˜é‡å‰¯æœ¬ï¼Œè¿™æ ·æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥ç‹¬ç«‹åœ°è®¿é—®å’Œä¿®æ”¹è‡ªå·±çš„å‰¯æœ¬ï¼Œè€Œä¸ä¼šå½±å“å…¶ä»–çº¿ç¨‹ã€‚ä¸‹é¢æ˜¯ä¸€äº›å…³äº `ThreadLocal` çš„ä½¿ç”¨ç¤ºä¾‹å’Œç¤ºä¾‹ä»£ç ï¼š

1. **SimpleDateFormat ç¤ºä¾‹**ï¼š
   - `SimpleDateFormat` æ˜¯ä¸€ä¸ªä¸çº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹å…±äº«åŒä¸€ä¸ªå®ä¾‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´é—®é¢˜ã€‚
   - ä½¿ç”¨ `ThreadLocal` å¯ä»¥ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ `SimpleDateFormat` å®ä¾‹ï¼Œé¿å…çº¿ç¨‹ä¹‹é—´çš„ç«äº‰ã€‚
   - ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

    ```java
    public class Foo {
        // SimpleDateFormat ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ‰€ä»¥ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªå®ä¾‹
        private static final ThreadLocal<SimpleDateFormat> formatter =
            ThreadLocal.withInitial(() -> new SimpleDateFormat("yyyy-MM-dd HH:mm:ss"));

        public static String format(Date date) {
            return formatter.get().format(date);
        }
    }
    ```

2. **UserSessionManager ç¤ºä¾‹**ï¼š
   - å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª `UserSessionManager` ç±»ï¼Œéœ€è¦åœ¨æ¯ä¸ªçº¿ç¨‹ä¸­å­˜å‚¨ç”¨æˆ·ä¼šè¯ä¿¡æ¯ã€‚
   - æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `ThreadLocal` æ¥ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ `userSessionInfo` å˜é‡ã€‚
   - ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š

    ```java
    public class UserSessionManager {
        private static final ThreadLocal<UserSessionInfo> userSessionInfo =
            ThreadLocal.withInitial(UserSessionInfo::new);

        public static UserSessionInfo getSessionInfo() {
            return userSessionInfo.get();
        }

        public static void setSessionInfo(UserSessionInfo sessionInfo) {
            userSessionInfo.set(sessionInfo);
        }

        public static void clearSessionInfo() {
            userSessionInfo.remove();
        }
    }
    ```

3. **å…¶ä»–ç¤ºä¾‹**ï¼š
   - ä½ è¿˜å¯ä»¥ä½¿ç”¨ `ThreadLocal` æ¥å­˜å‚¨å…¶ä»–ç±»å‹çš„çº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥ã€è¯·æ±‚ä¸Šä¸‹æ–‡ç­‰ã€‚

å¸Œæœ›è¿™äº›ç¤ºä¾‹å¯¹ä½ ç†è§£ `ThreadLocal` æœ‰æ‰€å¸®åŠ©ï¼å¦‚æœä½ è¿˜æœ‰å…¶ä»–é—®é¢˜ï¼Œè¯·éšæ—¶æé—®ã€‚ğŸ™‚
\-
\[1]: [When and how should I use a ThreadLocal variable?](https://stackoverflow.com/questions/817856/when-and-how-should-i-use-a-threadlocal-variable)
\[2]: [java - Using ThreadLocal in instance variables - Stack Overflow](https://stackoverflow.com/questions/9654455/using-threadlocal-in-instance-variables)
\[3]: [Java Thread-Local Variables: Explained - DZone](https://dzone.com/articles/mastering-thread-local-variables-in-java-a-compreh)
\[4]: [An Introduction to ThreadLocal in Java | Baeldung](https://www.baeldung.com/java-threadlocal)
\[5]: [Java ThreadLocal Example | DigitalOcean](https://www.digitalocean.com/community/tutorials/java-threadlocal-example)

<hr/>

