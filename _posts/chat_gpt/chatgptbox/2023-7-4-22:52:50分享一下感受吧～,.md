Question:

Reply in Chinese (Simplified).
The following is the text content of a web page,analyze the core content and summarize:
Redis系列 - 主从库模式、哨兵和分片集群
买个橘子
2020-11-12 09:51
1571
主从库模式Redis的高可靠性主要包括两方面：数据尽量少丢失：RDB & AOF机制
服务尽量少中断：增加副本冗余
主从模式Redis提供了主从库模式,增加冗余的副本来提高Redis集群的高可靠性,主从库之间采用读写分离的方式,写请求只能在主库,读请求在主从库都可以完成,若从库和主库上都可以进行读写会发生什么,并且分别请求到了不同实例上,v2,v3,那么key1对应的值在每个实例上都是不一致的,2. 若要保持这个数据在3个实例上都是一致的,得不偿失,并告诉主库即将进行同步,首先,psync 命令包含了主库的 runID 和复制进度 offset 两个参数,用来唯一标记这个实例,所以将 runID 设为“,此时设为 -1,也就是说,主库将所有数据同步给从库,为了保证主从库的数据一致性,主库会把第二阶段执行过程中新收到的写命令,当主库完成 RDB 文件发送后,这样一来,增量复制的过程主要是主服务器每执行一个写命令就会向从服务器发送相同的写命令,从节点部分复制（增量复制）的数据均来自于repl_backlog_buffer,所有的从库都是和主库连接,我们可以通过“主 - 从 - 从”模式将主库生成 RDB 和传输 RDB 的压力,从节点部分复制（增量复制）的数据均来自于repl_backlog_buffer,当主从库断连后,同时也会把这些操作命令也写入 repl_backlog_buffer 这个缓冲区,主库来的偏移量是master_repl_offset,主从库的连接恢复之后,主库会判断自己的 master_repl_offset 和 slave_repl_offset 之间的差距,所以,此时,主从库实例运行的同时,哨兵节点其实就是一个特殊的Redis实例节点,监控哨兵与没一个Redis节点相连接并通过PING命令检测它自己和主、从库的网络连接情况,如果检测的是从库,因为从库的下线影响一般不太大,那么,因为很有可能存在这么一个情况：那就是哨兵误判了,一旦启动了主从切换,只有大多数的哨兵实例,这个叫法也是表明主库下线成为一个客观事实了,这会进一步触发哨兵开始主从切换流程,选主主要包括以下三个原则,其次,ID 号小的从库得分高,你有两个从库,在选主时,那么它就是新主库了,这个规则的依据是,这个新主库上就有最新的数据,主库会用 master_repl_offset 记录当前的最新写操作在 repl_backlog_buffer 中的位置,目前,ID 号最小的从库得分最高,如Redis集群的数据量有5G增长到了25G,包括增加内存容量、增加磁盘容量、使用更高配置的 CPU,如果数据量增加,原来使用 1 个 *GB 内存、10GB 磁盘的实例,数据需要分布在不同实例上,这就和接下来我要讲的 Redis Cluster 方案有关了,Redis Cluster 方案采用哈希槽（Hash Slot,在 Redis Cluster 方案中,每个键值对都会根据它的 key,然后,每个模数代表一个相应编号的哈希槽,数据、哈希槽、实例这三者的映射分布情况,但是,是不知道其他实例拥有的哈希槽信息的,都能获得所有的哈希槽信息呢,当实例之间相互连接后,会把哈希槽信息缓存在本地,然后就可以给相应的实例发送请求了,实例有新增或删除,所谓的“重定向”,这个实例上并没有相应的数据,当客户端给实例 2 发送命令时,如果 Slot 2 中的数据比较多,Slot 2 中的数据只有一部分迁移到了实例 3,客户端就会收到一条 ASK 报错信息,在实例3上,客户端需要先给 实例3这个实例发送一个 ASKING 命令,客户端再向这个实例发送 GET 命令,Slot 2 正在从实例 2 往实例 3 迁移,客户端向实例 2 请求 key2 后,客户端需要给实例 3 发送 ASKING 命令,然后再发送操作命令,ASK 命令并不会更新客户端缓存的哈希槽分配信息,标签：
Redis
相关小册
VIP 深入理解 TCP 协议：从原理到实战
挖坑的张师傅
7656购买
¥24.95
¥49.9
首单券后价
VIP 从 0 开始深入学习 Spring
LinkedBear
4746购买
¥24.95
¥49.9
首单券后价
评论
看完啦,登录
分享一下感受吧～,

Answer:

您好，这是必应。我可以帮您分析网页的核心内容并进行摘要。😊

网页的核心内容是介绍了 Redis 的主从库模式、哨兵和分片集群的原理和实现，以及它们在提高 Redis 的高可靠性、高性能和高扩展性方面的作用。

网页的摘要如下：

- 主从库模式是通过增加副本冗余来提高 Redis 的可用性，主库负责写操作，从库负责读操作，主从之间通过全量复制和增量复制来保持数据一致性。
- 哨兵是一个特殊的 Redis 实例节点，负责监控主从库的状态，当主库出现故障时，哨兵会通过投票选举出一个新的主库，并通知客户端。
- 分片集群是通过哈希槽将数据分布在不同的实例上来提高 Redis 的扩展性，客户端可以根据哈希槽信息找到相应的实例进行操作，当实例发生变化时，客户端会收到重定向或询问的报错信息，并根据情况更新哈希槽信息或发送特殊命令。

请问您还有其他问题吗？👋

<hr/>

